modified from branchTest
modified for a second time
